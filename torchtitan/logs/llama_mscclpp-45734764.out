Starting Training with MSCCL++ (Job ID: 45734764)...
0: [titan] 2025-11-26 21:48:38,907 - root - INFO - Starting job: Llama 3 8B All-Reduce Benchmark
2: [titan] 2025-11-26 21:48:38,920 - root - INFO - Starting job: Llama 3 8B All-Reduce Benchmark
3: [titan] 2025-11-26 21:48:38,923 - root - INFO - Starting job: Llama 3 8B All-Reduce Benchmark
1: [titan] 2025-11-26 21:48:38,929 - root - INFO - Starting job: Llama 3 8B All-Reduce Benchmark
3: [titan] 2025-11-26 21:48:39,911 - root - INFO - Building 1-D device mesh with ['dp_replicate'], [4]
0: [titan] 2025-11-26 21:48:39,911 - root - INFO - Building 1-D device mesh with ['dp_replicate'], [4]
1: [titan] 2025-11-26 21:48:39,911 - root - INFO - Building 1-D device mesh with ['dp_replicate'], [4]
2: [titan] 2025-11-26 21:48:39,911 - root - INFO - Building 1-D device mesh with ['dp_replicate'], [4]
2: [titan] 2025-11-26 21:48:39,969 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
1: [titan] 2025-11-26 21:48:39,969 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
0: [titan] 2025-11-26 21:48:39,969 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
3: [titan] 2025-11-26 21:48:39,969 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
3: [titan] 2025-11-26 21:48:40,158 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
3: [titan] 2025-11-26 21:48:40,158 - root - INFO - Preparing c4 dataset from allenai/c4
0: [titan] 2025-11-26 21:48:40,159 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
0: [titan] 2025-11-26 21:48:40,159 - root - INFO - Preparing c4 dataset from allenai/c4
2: [titan] 2025-11-26 21:48:40,161 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
2: [titan] 2025-11-26 21:48:40,161 - root - INFO - Preparing c4 dataset from allenai/c4
1: [titan] 2025-11-26 21:48:40,165 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
1: [titan] 2025-11-26 21:48:40,165 - root - INFO - Preparing c4 dataset from allenai/c4
1: Request d79c8981-abc5-4ad4-ac9e-7efc7ae72e49: HEAD https://huggingface.co/datasets/allenai/c4/resolve/main/README.md (authenticated: True)
2: Request 77605e7c-8787-49a1-b6d2-e8a7a0c2dc9a: HEAD https://huggingface.co/datasets/allenai/c4/resolve/main/README.md (authenticated: True)
0: Request 2d38ad0e-8352-4359-8442-1db28b727bee: HEAD https://huggingface.co/datasets/allenai/c4/resolve/main/README.md (authenticated: True)
3: Request 45163723-b7be-40d3-b540-fb07ad607404: HEAD https://huggingface.co/datasets/allenai/c4/resolve/main/README.md (authenticated: True)
0: Request eb52e1cf-5122-410e-9526-8bcc5ff9d965: HEAD https://huggingface.co/api/resolve-cache/datasets/allenai/c4/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/README.md (authenticated: True)
3: Request 3ce43fed-aca8-4470-b139-8ae7a175fefb: HEAD https://huggingface.co/api/resolve-cache/datasets/allenai/c4/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/README.md (authenticated: True)
2: Request ae932e65-69cf-44f3-9de1-4b8dc2d631dd: HEAD https://huggingface.co/api/resolve-cache/datasets/allenai/c4/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/README.md (authenticated: True)
1: Request 555d5cd4-a3d4-4919-b60a-09269de87574: HEAD https://huggingface.co/api/resolve-cache/datasets/allenai/c4/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/README.md (authenticated: True)
3: Request cad0da02-043b-4ac2-aa8f-00ba571a0709: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/c4.py (authenticated: True)
0: Request f485928c-932f-483d-9464-797b1e499883: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/c4.py (authenticated: True)
2: Request de1b5dd8-409e-4ca2-8798-e5cd5a7a55f3: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/c4.py (authenticated: True)
1: Request 11f12b05-f18f-4182-9168-9b65de979509: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/c4.py (authenticated: True)
3: Request 41478785-960f-4e26-ab93-07b0e735b4db: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/allenai/c4/allenai/c4.py (authenticated: False)
0: Request 9d345bcd-92ac-451b-b094-0ccf9789750b: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/allenai/c4/allenai/c4.py (authenticated: False)
2: Request a08ef799-3709-4b4d-b265-21fefd030fde: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/allenai/c4/allenai/c4.py (authenticated: False)
1: Request 43701fe9-8084-4a3e-8d29-9e7f37697298: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/allenai/c4/allenai/c4.py (authenticated: False)
2: Request 86585d73-47fe-49d6-a0f2-0893015eade7: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
0: Request 138f6b9c-bb3f-4846-b76b-82596774b45d: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
3: Request 53ccfe9b-26fa-493d-9c4e-720942d41ffb: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
1: Request 7d3ded04-07b1-4f52-970d-d01958f1959e: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
3: Request 20bc366e-ea55-46ae-832e-dd7b6986d955: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/.huggingface.yaml (authenticated: True)
1: Request 937adba9-1fe0-45bb-a10f-a07bff062661: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/.huggingface.yaml (authenticated: True)
2: Request 241d8657-d814-4d1c-b8d2-d8fd19de4b0f: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/.huggingface.yaml (authenticated: True)
0: Request 04da7c2b-d48e-493e-bbbb-4edb267f5fb8: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/.huggingface.yaml (authenticated: True)
3: Request 6a95a381-44d2-4215-8962-ae579112d949: GET https://datasets-server.huggingface.co/info?dataset=allenai/c4 (authenticated: True)
1: Request d765197b-307f-4bf5-990e-df448cc358ec: GET https://datasets-server.huggingface.co/info?dataset=allenai/c4 (authenticated: True)
0: Request bdb19107-3238-4c0f-84c5-087afb2466a3: GET https://datasets-server.huggingface.co/info?dataset=allenai/c4 (authenticated: True)
2: Request 24a8a482-1fd8-481f-898c-f1c2dcc913fb: GET https://datasets-server.huggingface.co/info?dataset=allenai/c4 (authenticated: True)
0: Request 7459371d-7854-4c99-84a2-dcc2be9b768b: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2?recursive=False&expand=False (authenticated: True)
2: Request b37fa5a3-e8ea-4985-aea2-77f237ffa333: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2?recursive=False&expand=False (authenticated: True)
1: Request b1402f90-9182-4514-b653-fc98db5b47e1: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2?recursive=False&expand=False (authenticated: True)
3: Request 7a7ca8af-e967-4c76-b56a-9f3787358aa3: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2?recursive=False&expand=False (authenticated: True)
0: Request f153799e-a49a-45bd-8455-47e652d14ed4: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
2: Request 5d431960-5feb-46fc-b76d-516806ffdd6c: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
3: Request def33567-c9c3-4af4-9bfb-971bf9938d34: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
1: Request 30d4508e-1401-4274-8d86-7b0b9c912818: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
3: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
3: Request 7e4bc833-50f0-42a1-95d8-1fedaf779a5f: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
0: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
0: Request 3fbcad83-c03d-4742-a1ba-dd440311e7e0: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
1: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
1: Request 34874ba6-7231-43ad-9161-0e59dd7bbff2: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
3: Request bf6951bd-685d-4dbc-b61b-7e2c1e646327: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/dataset_infos.json (authenticated: True)
2: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
2: Request 38406a86-b249-4ab3-8349-a9c7c49f2625: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
0: Request 6962d9a5-bedb-4839-9ea1-6742cd1af52d: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/dataset_infos.json (authenticated: True)
1: Request 94a318a3-0494-47a2-b560-b96c438636bc: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/dataset_infos.json (authenticated: True)
3: [titan] 2025-11-26 21:48:43,027 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=128001)
2: Request 8a4e5bc7-8aa0-4fb1-891c-605c18594bed: HEAD https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/dataset_infos.json (authenticated: True)
0: [titan] 2025-11-26 21:48:43,101 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=128001)
1: [titan] 2025-11-26 21:48:43,209 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=128001)
2: [titan] 2025-11-26 21:48:43,254 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=128001)
3: [titan] 2025-11-26 21:48:43,390 - root - INFO - CUDA capacity: NVIDIA A100-SXM4-40GB with 39.38GiB memory
0: [titan] 2025-11-26 21:48:43,393 - root - INFO - CUDA capacity: NVIDIA A100-SXM4-40GB with 39.38GiB memory
3: [titan] 2025-11-26 21:48:43,405 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
0: [titan] 2025-11-26 21:48:43,406 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
3: [titan] 2025-11-26 21:48:43,406 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
0: [titan] 2025-11-26 21:48:43,406 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
3: [titan] 2025-11-26 21:48:43,407 - root - INFO - Applied selective activation checkpointing to the model
0: [titan] 2025-11-26 21:48:43,407 - root - INFO - Applied selective activation checkpointing to the model
3: [titan] 2025-11-26 21:48:43,410 - root - INFO - Applied DDP to the model
0: [titan] 2025-11-26 21:48:43,411 - root - INFO - Applied DDP to the model
1: [titan] 2025-11-26 21:48:43,501 - root - INFO - CUDA capacity: NVIDIA A100-SXM4-40GB with 39.38GiB memory
1: [titan] 2025-11-26 21:48:43,506 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
1: [titan] 2025-11-26 21:48:43,507 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
1: [titan] 2025-11-26 21:48:43,508 - root - INFO - Applied selective activation checkpointing to the model
1: [titan] 2025-11-26 21:48:43,511 - root - INFO - Applied DDP to the model
2: [titan] 2025-11-26 21:48:43,547 - root - INFO - CUDA capacity: NVIDIA A100-SXM4-40GB with 39.38GiB memory
2: [titan] 2025-11-26 21:48:43,552 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
2: [titan] 2025-11-26 21:48:43,553 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
2: [titan] 2025-11-26 21:48:43,554 - root - INFO - Applied selective activation checkpointing to the model
2: [titan] 2025-11-26 21:48:43,557 - root - INFO - Applied DDP to the model
1: [titan] 2025-11-26 21:48:43,735 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
1: [titan] 2025-11-26 21:48:43,736 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
3: [titan] 2025-11-26 21:48:43,736 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
1: [titan] 2025-11-26 21:48:43,737 - root - INFO - CUDA memory usage for model: 29.94GiB(76.01%)
3: [titan] 2025-11-26 21:48:43,737 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
2: [titan] 2025-11-26 21:48:43,737 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
3: [titan] 2025-11-26 21:48:43,737 - root - INFO - CUDA memory usage for model: 29.94GiB(76.01%)
2: [titan] 2025-11-26 21:48:43,737 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
2: [titan] 2025-11-26 21:48:43,737 - root - INFO - CUDA memory usage for model: 29.94GiB(76.01%)
0: [titan] 2025-11-26 21:48:43,737 - root - WARNING - Error running lspci: [Errno 2] No such file or directory: 'lspci', fallback to use device_name
0: [titan] 2025-11-26 21:48:43,737 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
0: [titan] 2025-11-26 21:48:43,737 - root - INFO - CUDA memory usage for model: 29.94GiB(76.01%)
1: [titan] 2025-11-26 21:48:43,738 - root - WARNING - Warmup steps (200) exceed total training steps (20). Adjusting warmup steps to 20.
1: [titan] 2025-11-26 21:48:43,738 - root - INFO - Mixed precision training is handled by AMP
3: [titan] 2025-11-26 21:48:43,738 - root - WARNING - Warmup steps (200) exceed total training steps (20). Adjusting warmup steps to 20.
3: [titan] 2025-11-26 21:48:43,738 - root - INFO - Mixed precision training is handled by AMP
2: [titan] 2025-11-26 21:48:43,738 - root - WARNING - Warmup steps (200) exceed total training steps (20). Adjusting warmup steps to 20.
1: [titan] 2025-11-26 21:48:43,739 - root - INFO - Trainer is initialized with local batch size 1, global batch size 4, gradient accumulation steps 1, sequence length 8192, total steps 20 (warmup 200).
3: [titan] 2025-11-26 21:48:43,739 - root - INFO - Trainer is initialized with local batch size 1, global batch size 4, gradient accumulation steps 1, sequence length 8192, total steps 20 (warmup 200).
2: [titan] 2025-11-26 21:48:43,739 - root - INFO - Mixed precision training is handled by AMP
3: [titan] 2025-11-26 21:48:43,739 - root - INFO - Training starts at step 1.
1: [titan] 2025-11-26 21:48:43,739 - root - INFO - Training starts at step 1.
2: [titan] 2025-11-26 21:48:43,739 - root - INFO - Trainer is initialized with local batch size 1, global batch size 4, gradient accumulation steps 1, sequence length 8192, total steps 20 (warmup 200).
1: [titan] 2025-11-26 21:48:43,739 - root - INFO - Profiling active. Traces will be saved at ./outputs/profile_trace
3: [titan] 2025-11-26 21:48:43,739 - root - INFO - Profiling active. Traces will be saved at ./outputs/profile_trace
2: [titan] 2025-11-26 21:48:43,739 - root - INFO - Training starts at step 1.
0: [titan] 2025-11-26 21:48:43,739 - root - WARNING - Warmup steps (200) exceed total training steps (20). Adjusting warmup steps to 20.
2: [titan] 2025-11-26 21:48:43,739 - root - INFO - Profiling active. Traces will be saved at ./outputs/profile_trace
0: [titan] 2025-11-26 21:48:43,739 - root - INFO - Mixed precision training is handled by AMP
0: [titan] 2025-11-26 21:48:43,739 - root - INFO - Trainer is initialized with local batch size 1, global batch size 4, gradient accumulation steps 1, sequence length 8192, total steps 20 (warmup 200).
0: [titan] 2025-11-26 21:48:43,739 - root - INFO - Training starts at step 1.
0: [titan] 2025-11-26 21:48:43,739 - root - INFO - Profiling active. Traces will be saved at ./outputs/profile_trace
1: Request b2beeb87-417b-42ee-a87b-72e7b65d4816: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
0: Request d306de39-caee-4d0d-83e8-611115209c83: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
3: Request 185ae80f-cc14-451a-9778-85b752ac0f48: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
2: Request 3d379c4c-61fa-4448-8a1b-afc352e197f7: GET https://huggingface.co/api/datasets/allenai/c4/revision/1588ec454efa1a09f29cd18ddd04fe05fc8653a2 (authenticated: True)
2: Request 7394f3fc-3c78-411e-a02a-621f87ff8cf4: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
3: Request c35b7705-ddb5-47de-a1d6-11df16977fd7: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
1: Request a864d479-304c-419f-b1ab-2af109ea1199: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
2: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
2: Request a2d13ba2-f519-4d29-a754-b577616d7349: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
3: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
3: Request 9af1be25-d88e-441c-bc50-5a12f243f38c: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
2: Request e4ed34fb-4091-4cbe-9c03-9c9614df94ac: GET https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en/c4-train.00002-of-01024.json.gz (authenticated: True)
1: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
1: Request dccc8053-de18-4ccc-bc14-3288281f3b31: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
3: Request b49a2ea4-c903-4c78-b39b-26c9f9f9582f: GET https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en/c4-train.00003-of-01024.json.gz (authenticated: True)
2: Request e4ed34fb-4091-4cbe-9c03-9c9614df94ac: GET https://cas-bridge.xethub.hf.co/xet-bridge-us/621ffdd236468d709f182a80/96adb94376f42df2255c7ad2fa02604236304fc487f7bb89b8bdee36a126f298?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20251127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251127T054335Z&X-Amz-Expires=3600&X-Amz-Signature=ef871a05841cbf55c3cf0f2e7dd5f7bfd3b0a21a95c29cbdf4e0a90572af46c7&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=6811c8e0c3f0c3e8a4576e87&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27c4-train.00002-of-01024.json.gz%3B+filename%3D%22c4-train.00002-of-01024.json.gz%22%3B&response-content-type=application%2Fgzip&x-id=GetObject&Expires=1764225815&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2NDIyNTgxNX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82MjFmZmRkMjM2NDY4ZDcwOWYxODJhODAvOTZhZGI5NDM3NmY0MmRmMjI1NWM3YWQyZmEwMjYwNDIzNjMwNGZjNDg3ZjdiYjg5YjhiZGVl
2: MzZhMTI2ZjI5OCoifV19&Signature=o1Tk7fFS8nPwNr5JLmzDTR35YZ75csamQeZVsg951DLRC7uMJg~R56b6eaYwAmzdP6HDlUZ3upASMvPY64OHfXN3SR14K6pvHLt~h2PovBFKzgCT0~dEE1Ucu4bYsencWgMe~cy4VOJ9hxz3e2pmn6ET-5BXOBx84kCw798nDyzt3NQIdkSpomlYObt-Se4qbXHQtfOUQbOqhUVJBLmhbntwf7F4wJPAcyvYnPe4A5i7vWxLcYINWqIl4HmFIa8wBkNgLannT2o12ksr7tLyemJuExF47xvIYeE2YvSmlbM80iC0G2nopqJKhXZNTjGK6OnBj-nDY78Ji7mtKauI4w__&Key-Pair-Id=K2L8F4GPSG1IFC (authenticated: False)
1: Request a01886d9-6a08-4ec5-83c1-a73c764fd045: GET https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en/c4-train.00001-of-01024.json.gz (authenticated: True)
3: Request b49a2ea4-c903-4c78-b39b-26c9f9f9582f: GET https://cas-bridge.xethub.hf.co/xet-bridge-us/621ffdd236468d709f182a80/a20f257af4ab58526d8f66b50d36299eec45b2e79f25d94c8cb8186322bfb888?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20251127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251127T054844Z&X-Amz-Expires=3600&X-Amz-Signature=b47c64d8c3e7e3efe95df195870e4c18702d6f684f29e7792d868c416799df9e&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=68c8ff31125b011e2ff95b13&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27c4-train.00003-of-01024.json.gz%3B+filename%3D%22c4-train.00003-of-01024.json.gz%22%3B&response-content-type=application%2Fgzip&x-id=GetObject&Expires=1764226124&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2NDIyNjEyNH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82MjFmZmRkMjM2NDY4ZDcwOWYxODJhODAvYTIwZjI1N2FmNGFiNTg1MjZkOGY2NmI1MGQzNjI5OWVlYzQ1YjJlNzlmMjVkOTRjOGNiODE4
3: NjMyMmJmYjg4OCoifV19&Signature=jWL3aGCn4l4nZ3L5oBkWEzUqXqxg0aNZ6P1ELrFuG2vp0VjMLA-hBOO9VZ62kNNhLiwJ2kI7Ij2-uDdZY1gejUCycUa-V3e1JMQlMFGTLsfZedLVzBiJAnm3ONS-YwzCHK1uWO5n9zSxOkzS3f4t4BSP-Mr7TCZGYYUK2VCsICW9zk2F5CkdL93UHph12IfiY5op8VuCEyh-Pax~9~rtNdoaR4ayPh9W-MFtx-KlAuR3GzFWS9t65wWjkEzT4ZCKbjIaTbiEbxdZtfCqIszGBsucDx7Hog0gQ6gg7FBoWA4IxmZY552bbfyCdjGdhwfASn12-RERhlR41K1qrYHrYg__&Key-Pair-Id=K2L8F4GPSG1IFC (authenticated: False)
1: Request a01886d9-6a08-4ec5-83c1-a73c764fd045: GET https://cas-bridge.xethub.hf.co/xet-bridge-us/621ffdd236468d709f182a80/9f36194e2bf0cd3bd27a023ec7519b36c0dcc5c236eb2695517969d070de9aac?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20251127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251127T054844Z&X-Amz-Expires=3600&X-Amz-Signature=6daa33bb184e360d35a1eb77864d20b71894e5a7fa02e4bff147a587ae3cc1f1&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=68c8ff31125b011e2ff95b13&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27c4-train.00001-of-01024.json.gz%3B+filename%3D%22c4-train.00001-of-01024.json.gz%22%3B&response-content-type=application%2Fgzip&x-id=GetObject&Expires=1764226124&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2NDIyNjEyNH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82MjFmZmRkMjM2NDY4ZDcwOWYxODJhODAvOWYzNjE5NGUyYmYwY2QzYmQyN2EwMjNlYzc1MTliMzZjMGRjYzVjMjM2ZWIyNjk1NTE3OTY5
1: ZDA3MGRlOWFhYyoifV19&Signature=SwUhp8z2z8HLuSCRXa1fvPaw0cMMB9fbPaMzWsx9Uva3vpcNcGEsFFhJm3xdM17cLUAVuqjqblxbn2BQ1Km~79FMhBxJKYi6Mo~-hxinImyvcTUH~xrWmLE1TP8zLocVdrW2lxl0CjchYtevSJ5sbiZN8~y3tozbdeSRXbXh-LqUCq~BP~Ca2edtvpGH9lpwYT48n3NKxi3ChbMQ8UnYjGSXKVLIrXxzVXOY5Z4kNaB-Is6v2BiwL32SutndQUpweWJDzNmoI-PPBzlKXSvzehIP4Q2Dg1NdCXRYt3mpKIGn~e-zNnp-OABz1PE7MBON-rg1ai2u71qFyurvUVgrZg__&Key-Pair-Id=K2L8F4GPSG1IFC (authenticated: False)
0: Request d3e11589-140c-4cdd-8209-1787bfc418d5: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?recursive=False&expand=False (authenticated: True)
0: Pagination detected. Requesting next page: https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D
0: Request a3831086-5228-4887-8edc-06219525f521: GET https://huggingface.co/api/datasets/allenai/c4/tree/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en?expand=false&recursive=false&limit=1000&cursor=ZXlKbWFXeGxYMjVoYldVaU9pSmxiaTlqTkMxMGNtRnBiaTR3TURrNU9TMXZaaTB3TVRBeU5DNXFjMjl1TG1kNklpd2lkSEpsWlY5dmFXUWlPaUprWXprME0yTTBZelF3WmpVelpEQXlZak14WTJWa01XUmxabUUzWlRWbU5ETTRaRFU0TmpKbEluMD06MTAwMA%3D%3D (authenticated: True)
0: Request a27bf65c-9d0f-4548-bf5a-711c2fed76aa: GET https://huggingface.co/datasets/allenai/c4/resolve/1588ec454efa1a09f29cd18ddd04fe05fc8653a2/en/c4-train.00000-of-01024.json.gz (authenticated: True)
0: Request a27bf65c-9d0f-4548-bf5a-711c2fed76aa: GET https://cas-bridge.xethub.hf.co/xet-bridge-us/621ffdd236468d709f182a80/6656aac078668b0d5feb1cfb7b04def05bff73e7e375d0a66e252827336ac1a8?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20251127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251127T054845Z&X-Amz-Expires=3600&X-Amz-Signature=7cdc4bdbc97ad064a20318eb5b9bf08b3ff3dd63fb07c211673555d22ae861cf&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=68c8ff31125b011e2ff95b13&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27c4-train.00000-of-01024.json.gz%3B+filename%3D%22c4-train.00000-of-01024.json.gz%22%3B&response-content-type=application%2Fgzip&x-id=GetObject&Expires=1764226125&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2NDIyNjEyNX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82MjFmZmRkMjM2NDY4ZDcwOWYxODJhODAvNjY1NmFhYzA3ODY2OGIwZDVmZWIxY2ZiN2IwNGRlZjA1YmZmNzNlN2UzNzVkMGE2NmUyNTI4
0: MjczMzZhYzFhOCoifV19&Signature=cu3l-81ioy-qxtMG0b0vKYDjmsBkln6YaHX7IK31EY76Oe6WlzOFuIqn7cDliGVQbEtQEaKp-srbdShVqfCzOE0YgzeWkA8BIxMJZ9wWgX6c64NMml0bSU8Mrnb3A1MLCTDM8Z1pSsaGXPVkvhYEpMHiPrJZ-KajEFME7sDWmqQDTW0sfnvCRo30acehg47adMjzIZrGePi2fKl1tF49lNAy3ulPrxmWADJLZbbsVY7Wvh3dMOvfxdDvDabYZRbzJ1V7KYscBZ29~ngalu2WGms7b8Rb1ZX5q5jFAvraj5ExlsBIbD1CdKxwvFmw7n6YJId-9Mkbm0vyxbM~zJjqbw__&Key-Pair-Id=K2L8F4GPSG1IFC (authenticated: False)
3: [titan] 2025-11-26 21:48:46,840 - root - INFO - Process group destroyed.
0: [titan] 2025-11-26 21:48:46,840 - root - INFO - Process group destroyed.
2: [titan] 2025-11-26 21:48:46,840 - root - INFO - Process group destroyed.
3: nid002493:1878773:1878773 [3] MSCCLPP INFO TcpBootstrap : Using nmn0:10.100.20.117<0>
3: nid002493:1878773:1878773 [3] MSCCLPP INFO rank 3 nranks 4 - connecting to 10.100.20.117<42773>
3: nid002493:1878773:1878773 [3] MSCCLPP INFO rank 3 - unix socket server started
3: nid002493:1878773:1879317 [3] MSCCLPP INFO NUMA node of ProxyService proxy thread is set to 0
3: nid002493:1878773:1878773 [3] MSCCLPP INFO Stopping unix socket server
0: nid002493:1878772:1878772 [0] MSCCLPP INFO TcpBootstrap : Using nmn0:10.100.20.117<0>
0: nid002493:1878772:1878772 [0] MSCCLPP INFO TcpBootstrap : Using nmn0:10.100.20.117<0>
0: nid002493:1878772:1878772 [0] MSCCLPP INFO rank 0 nranks 4 - connecting to 10.100.20.117<42773>
0: nid002493:1878772:1878772 [0] MSCCLPP INFO rank 0 - unix socket server started
0: nid002493:1878772:1879322 [0] MSCCLPP INFO NUMA node of ProxyService proxy thread is set to 3
0: nid002493:1878772:1878772 [0] MSCCLPP INFO Stopping unix socket server
1: [titan] 2025-11-26 21:48:46,840 - root - INFO - Process group destroyed.
2: nid002493:1878775:1878775 [2] MSCCLPP INFO TcpBootstrap : Using nmn0:10.100.20.117<0>
2: nid002493:1878775:1878775 [2] MSCCLPP INFO rank 2 nranks 4 - connecting to 10.100.20.117<42773>
2: nid002493:1878775:1878775 [2] MSCCLPP INFO rank 2 - unix socket server started
2: nid002493:1878775:1879316 [2] MSCCLPP INFO NUMA node of ProxyService proxy thread is set to 1
2: nid002493:1878775:1878775 [2] MSCCLPP INFO Stopping unix socket server
1: nid002493:1878774:1878774 [1] MSCCLPP INFO TcpBootstrap : Using nmn0:10.100.20.117<0>
1: nid002493:1878774:1878774 [1] MSCCLPP INFO rank 1 nranks 4 - connecting to 10.100.20.117<42773>
1: nid002493:1878774:1878774 [1] MSCCLPP INFO rank 1 - unix socket server started
1: nid002493:1878774:1879320 [1] MSCCLPP INFO NUMA node of ProxyService proxy thread is set to 2
1: nid002493:1878774:1878774 [1] MSCCLPP INFO Stopping unix socket server
1: [rank1]: Traceback (most recent call last):
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 196, in _run_module_as_main
1: [rank1]:     return _run_code(code, main_globals, None,
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 86, in _run_code
1: [rank1]:     exec(code, run_globals)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 553, in <module>
1: [rank1]:     trainer.train()
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
1: [rank1]:     return f(*args, **kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 492, in train
1: [rank1]:     self.train_step(data_iterator)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 431, in train_step
1: [rank1]:     loss = self.forward_backward_step(input_dict, labels)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 409, in forward_backward_step
1: [rank1]:     pred = model_parts[0](inputs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
1: [rank1]:     return self._call_impl(*args, **kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
1: [rank1]:     return inner()
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1808, in inner
1: [rank1]:     args_kwargs_result = hook(self, args, kwargs)  # type: ignore[misc]
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 132, in forward_pre_hook
1: [rank1]:     self.lazy_init()
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 75, in lazy_init
1: [rank1]:     _lazy_init()
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_compile.py", line 53, in inner
1: [rank1]:     return disable_fn(*args, **kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
1: [rank1]:     return fn(*args, **kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 70, in _lazy_init
1: [rank1]:     self.init(*self._init_args, **self._init_kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 115, in init
1: [rank1]:     self._ddp = DistributedDataParallel(self._param_list, **kwargs)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 858, in __init__
1: [rank1]:     _verify_param_shape_across_processes(self.process_group, parameters)
1: [rank1]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/utils.py", line 281, in _verify_param_shape_across_processes
1: [rank1]:     return dist._verify_params_across_processes(process_group, tensors, logger)
1: [rank1]: RuntimeError: Unsupported ncclDataType_t: 4 (mscclpp failure: InvalidUsage)
3: [rank3]: Traceback (most recent call last):
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 196, in _run_module_as_main
3: [rank3]:     return _run_code(code, main_globals, None,
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 86, in _run_code
3: [rank3]:     exec(code, run_globals)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 553, in <module>
3: [rank3]:     trainer.train()
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
3: [rank3]:     return f(*args, **kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 492, in train
3: [rank3]:     self.train_step(data_iterator)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 431, in train_step
3: [rank3]:     loss = self.forward_backward_step(input_dict, labels)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 409, in forward_backward_step
3: [rank3]:     pred = model_parts[0](inputs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
3: [rank3]:     return self._call_impl(*args, **kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
3: [rank3]:     return inner()
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1808, in inner
3: [rank3]:     args_kwargs_result = hook(self, args, kwargs)  # type: ignore[misc]
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 132, in forward_pre_hook
3: [rank3]:     self.lazy_init()
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 75, in lazy_init
3: [rank3]:     _lazy_init()
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_compile.py", line 53, in inner
3: [rank3]:     return disable_fn(*args, **kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
3: [rank3]:     return fn(*args, **kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 70, in _lazy_init
3: [rank3]:     self.init(*self._init_args, **self._init_kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 115, in init
3: [rank3]:     self._ddp = DistributedDataParallel(self._param_list, **kwargs)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 858, in __init__
3: [rank3]:     _verify_param_shape_across_processes(self.process_group, parameters)
3: [rank3]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/utils.py", line 281, in _verify_param_shape_across_processes
3: [rank3]:     return dist._verify_params_across_processes(process_group, tensors, logger)
3: [rank3]: RuntimeError: Unsupported ncclDataType_t: 4 (mscclpp failure: InvalidUsage)
0: [rank0]: Traceback (most recent call last):
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 196, in _run_module_as_main
0: [rank0]:     return _run_code(code, main_globals, None,
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 86, in _run_code
0: [rank0]:     exec(code, run_globals)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 553, in <module>
0: [rank0]:     trainer.train()
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
0: [rank0]:     return f(*args, **kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 492, in train
0: [rank0]:     self.train_step(data_iterator)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 431, in train_step
0: [rank0]:     loss = self.forward_backward_step(input_dict, labels)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 409, in forward_backward_step
0: [rank0]:     pred = model_parts[0](inputs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
0: [rank0]:     return self._call_impl(*args, **kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
0: [rank0]:     return inner()
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1808, in inner
0: [rank0]:     args_kwargs_result = hook(self, args, kwargs)  # type: ignore[misc]
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 132, in forward_pre_hook
0: [rank0]:     self.lazy_init()
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 75, in lazy_init
0: [rank0]:     _lazy_init()
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_compile.py", line 53, in inner
0: [rank0]:     return disable_fn(*args, **kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
0: [rank0]:     return fn(*args, **kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 70, in _lazy_init
0: [rank0]:     self.init(*self._init_args, **self._init_kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 115, in init
0: [rank0]:     self._ddp = DistributedDataParallel(self._param_list, **kwargs)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 858, in __init__
0: [rank0]:     _verify_param_shape_across_processes(self.process_group, parameters)
0: [rank0]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/utils.py", line 281, in _verify_param_shape_across_processes
0: [rank0]:     return dist._verify_params_across_processes(process_group, tensors, logger)
0: [rank0]: RuntimeError: Unsupported ncclDataType_t: 4 (mscclpp failure: InvalidUsage)
2: [rank2]: Traceback (most recent call last):
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 196, in _run_module_as_main
2: [rank2]:     return _run_code(code, main_globals, None,
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/runpy.py", line 86, in _run_code
2: [rank2]:     exec(code, run_globals)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 553, in <module>
2: [rank2]:     trainer.train()
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
2: [rank2]:     return f(*args, **kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 492, in train
2: [rank2]:     self.train_step(data_iterator)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 431, in train_step
2: [rank2]:     loss = self.forward_backward_step(input_dict, labels)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torchtitan/train.py", line 409, in forward_backward_step
2: [rank2]:     pred = model_parts[0](inputs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
2: [rank2]:     return self._call_impl(*args, **kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1881, in _call_impl
2: [rank2]:     return inner()
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1808, in inner
2: [rank2]:     args_kwargs_result = hook(self, args, kwargs)  # type: ignore[misc]
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 132, in forward_pre_hook
2: [rank2]:     self.lazy_init()
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 75, in lazy_init
2: [rank2]:     _lazy_init()
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_compile.py", line 53, in inner
2: [rank2]:     return disable_fn(*args, **kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
2: [rank2]:     return fn(*args, **kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 70, in _lazy_init
2: [rank2]:     self.init(*self._init_args, **self._init_kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/_composable/replicate.py", line 115, in init
2: [rank2]:     self._ddp = DistributedDataParallel(self._param_list, **kwargs)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 858, in __init__
2: [rank2]:     _verify_param_shape_across_processes(self.process_group, parameters)
2: [rank2]:   File "/pscratch/sd/x/xz987/conda_storage/.conda/envs/ccl-bench/lib/python3.10/site-packages/torch/distributed/utils.py", line 281, in _verify_param_shape_across_processes
2: [rank2]:     return dist._verify_params_across_processes(process_group, tensors, logger)
2: [rank2]: RuntimeError: Unsupported ncclDataType_t: 4 (mscclpp failure: InvalidUsage)
srun: error: nid002493: task 0: Exited with exit code 1
srun: Terminating StepId=45734764.0
0: slurmstepd: error: *** STEP 45734764.0 ON nid002493 CANCELLED AT 2025-11-27T05:48:48 ***
srun: error: nid002493: tasks 1-3: Terminated
srun: Force Terminated StepId=45734764.0
